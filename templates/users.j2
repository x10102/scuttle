{% extends "base.j2" %}

{% block content %}
<div class="md:p-2 flex flex-col items-center justify-center w-auto">
    <div class="md:mt-4 md:w-auto md:flex-row md:rounded-xl bg-opacity-5 flex flex-col items-center w-full px-10 py-5 mb-8 bg-white shadow-2xl">
    <h2 class="md:mr-6 text-lg font-bold">Řadit:</h2>
    <a href="{{url_for('index', sort='az')}}" class="hover:bg-green-500 md:w-auto md:my-0 md:mx-1 btn-rounded w-4/5 my-2 bg-green-600">A-Z</a>
    <a href="{{url_for('index', sort='count')}}" class="hover:bg-green-500 md:my-0 md:w-auto md:mx-1 btn-rounded w-4/5 my-2 bg-green-600">Počet článků</a>
    <a href="{{url_for('index', sort='points')}}" class="hover:bg-green-500 md:my-0 md:w-auto md:mx-1 btn-rounded w-4/5 my-2 bg-green-600">Počet bodů</a>
    </div>
    <div class="opacity-40 italic">Aktualizováno {{lastupdate}}</div>
    <table class="md:bg-white md:border-separate md:table-auto md:py-5 md:w-auto border-spacing-x-10 md:rounded-xl md:bg-opacity-5 md:backdrop-blur-2xl w-full mt-2 text-center shadow-2xl">
    <thead>
        <tr class="border-b-2 border-black">
            <th>Nickname</th>
            <th>Discord</th>
            <th>Celkem překladů</th>
            <th>Celkem bodů</th>
            <th>Aktuální role</th>
            {% if current_user.is_authenticated %}
            <th></th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr class="md:p-4 h-10" id="u-{{user.id}}">
            <td data-label="Přezdívka">{{ user.nickname }}</td>
            <td data-label="Discord ID">
            {% if user.discord %}
            <img class="w-8 h-8 rounded-[50%] inline md:mr-4" src={{ url_for('UserContent.get_avatar', uid=(user.discord or 0)) }}>
            {{ user.display or user.discord }}
            {% endif %}</td>
            <td data-label="Počet překladů">{{ user.count }}</td>
            <td data-label="Počet bodů">{{ "%.1f" % user.points }}</td>
            <td data-label="Role">{{get_user_role(user.points)}}</td>
            <td class="md:table-row flex flex-col">
                <a class="btn-rounded hover:bg-blue-500 md:inline md:w-auto md:mb-0 inline-block w-full mb-2 bg-blue-600" href="{{url_for('UserController.user', uid=user.id)}}">Zobrazit</a>
                {% if current_user.is_authenticated %}
                <a class="btn-rounded hover:bg-red-400 bg-red-600" onclick="delete_confirm(this);">Smazat</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
    </table>
</div>
<div id="overlay-flex" class="fixed top-0 left-0 z-40 flex flex-col items-center justify-center hidden w-full h-full overflow-hidden transition-all bg-transparent">
    <div id="overlay-dialog" class="border-slate-400 bg-slate-900 z-50 flex flex-col items-center justify-center px-8 py-6 border rounded-lg">
        <h2 class="mb-2 text-xl font-semibold">Potvrzení</h2>
        <p id='confirm-text' class="mb-4"></p>
        <div id='confirm-buttons' class="flex flex-row justify-center w-auto">
            <a class="w-36 btn-rounded hover:bg-green-500 mx-1 bg-green-600" onclick="delete_send(this);">Ano</a>
            <a class="w-36 btn-rounded hover:bg-red-500 mx-1 bg-red-600" onclick="hide_overlay();">Ne</a>
        </div>
    </div>
</div>
<div id="overlay" class=" bg-white/10 backdrop-blur-md fixed top-0 left-0 z-30 hidden w-full h-full overflow-hidden transition-all">
</div>

<script src="{{url_for('static', filename='js/confirm.js')}}"></script>
{% endblock content %}